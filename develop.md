# 吃豆人游戏开发计划

## 项目概述
使用C语言和libsx图形库开发简化版吃豆人游戏，采用模块化设计，逻辑引擎与图形界面分离。

## Ubuntu开发环境搭建

### 自动化安装脚本

为了简化环境搭建过程，我们提供了自动化安装脚本 `setup_environment.sh`，该脚本包含完整的错误处理和状态提示。

#### 使用方法：

1. **赋予脚本执行权限**
```bash
chmod +x setup_environment.sh
```

2. **运行安装脚本**
```bash
./setup_environment.sh
```

#### 脚本功能特性：

- ✅ **系统检查**：自动检测Ubuntu系统和网络连接
- ✅ **依赖安装**：自动安装所有必要的开发工具和库
- ✅ **libsx安装**：自动下载、编译、安装libsx库（支持备用源）
- ✅ **错误处理**：详细的错误信息和彩色输出
- ✅ **安装验证**：自动验证所有组件是否正确安装
- ✅ **项目初始化**：自动创建项目目录结构
- ✅ **测试环境**：提供Makefile进行编译环境测试

#### 手动安装（备用方案）：

如果自动脚本遇到问题，可以手动执行以下步骤：

```bash
# 1. 更新包管理器
sudo apt update

# 2. 安装基础开发工具
sudo apt install build-essential gcc make wget tar

# 3. 安装X11开发库
sudo apt install libx11-dev libxt-dev libxaw7-dev

# 4. 安装libsx开发库
sudo apt-get install libsx-dev

# 5. 创建项目目录
mkdir -p ~/PacMan/{src,include}
cd ~/PacMan
```

#### 验证安装：

安装完成后，进入项目目录测试编译环境：

```bash
cd ./PacMan
make test
```

如果看到 "libsx环境配置成功!" 和 "环境测试完成！" 消息，说明环境搭建成功。

## 阶段性功能拆分（5个阶段）

### 第一阶段：图形界面框架搭建
**目标：** 优先建立可视化界面，便于测试

#### 1.1 项目结构设计
- 创建头文件：
  - `gui.h` - 图形界面相关定义
  - `types.h` - 数据结构和常量定义
- 创建源文件：
  - `main.c` - 程序入口和参数处理
  - `gui.c` - 图形界面实现

#### 1.2 基础图形界面
- 使用libsx创建主窗口
- 实现基本的棋盘网格显示
- 添加基础按钮布局（方向键、功能按钮）
- 创建状态显示区域

#### 1.3 编译环境
- 创建Makefile文件
- 配置libsx库链接
- 设置-Wall编译选项

### 第二阶段：核心数据结构和基础逻辑
**目标：** 定义游戏数据结构并实现基本移动

#### 2.1 数据结构定义
- 游戏状态结构体（GameState）
- 移动方向枚举（Direction）
- 棋盘和玩家位置管理

#### 2.2 基础游戏逻辑
- 棋盘初始化和棋子随机生成
- 玩家移动逻辑实现
- 简单的碰撞检测和边界处理

#### 2.3 图形界面集成
- 将游戏状态与图形显示连接
- 实现玩家角色和棋子的绘制
- 基础的界面刷新机制

### 第三阶段：用户交互和控制系统
**目标：** 实现完整的用户交互功能

#### 3.1 按钮控制系统
- 方向控制按钮（上、下、左、右）
- 功能按钮（Rejouer、Aide、Quit）
- 按钮回调函数实现

#### 3.2 键盘输入处理
- 方向键输入处理
- 键盘事件绑定和响应

#### 3.3 游戏状态显示
- 移动步数计数器
- 收集棋子计数器
- 剩余棋子数显示
- 实时状态更新

### 第四阶段：自动移动算法实现
**目标：** 实现三种自动移动算法

#### 4.1 算法框架
- 创建algorithms.c文件
- 定义算法接口和状态管理

#### 4.2 三种算法实现
- Random算法：随机选择有效方向
- Zig-Zag算法：之字形移动模式
- DFS算法：深度优先搜索路径规划

#### 4.3 算法控制按钮
- "Random"、"Zig-Zag"、"Dfs"按钮
- 算法切换和状态管理
- 自动移动的启动和停止

### 第五阶段：完善和优化
**目标：** 代码优化、错误处理和最终测试

#### 5.1 游戏完整性
- 游戏胜利条件检测
- 重新开始功能完善
- 帮助信息显示

#### 5.2 代码质量提升
- 添加完整注释（前置条件、后置条件、循环不变式）
- 优化变量命名和代码缩进
- 函数长度控制和模块化优化

#### 5.3 错误处理和测试
- 参数验证和错误处理
- 内存管理和资源释放
- 编译警告消除（-Wall选项）
- 功能完整性测试

## 开发里程碑

| 阶段 | 预计完成时间 | 主要交付物 |
|------|-------------|------------|
| 第1阶段 | 第1周 | 图形界面框架、基础显示 |
| 第2阶段 | 第2周 | 数据结构、基础逻辑 |
| 第3阶段 | 第3周 | 用户交互、状态显示 |
| 第4阶段 | 第4周 | 自动算法、控制系统 |
| 第5阶段 | 第5周 | 完善优化、最终测试 |

## 技术要点

### 关键技术难点
1. libsx图形库的使用和事件处理
2. DFS算法的实现和路径优化
3. 图形界面与游戏逻辑的分离设计
4. 内存管理和动态数组处理

### 代码规范
- 使用一致的命名约定（snake_case）
- 每个函数不超过50行
- 适当的注释密度（关键逻辑必须注释）
- 模块间接口清晰，耦合度低

## 文件组织结构
```
PacMan/
├── src/
│   ├── main.c
│   ├── game.c
│   ├── gui.c
│   └── algorithms.c
├── include/
│   ├── game.h
│   ├── gui.h
│   └── types.h
├── Makefile
└── README.md
```